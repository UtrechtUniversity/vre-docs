<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Getting Started</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../_styles/styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../docs/research-cloud-intro.html" rel="" target="">
 <span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../docs/accounts.html" rel="" target="">
 <span class="menu-text">Accounts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../docs/getting-started.html" rel="" target="" aria-current="page">
 <span class="menu-text">Getting Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../docs/workspace-catalogue.html" rel="" target="">
 <span class="menu-text">Workspaces</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../docs/manuals.html" rel="" target="">
 <span class="menu-text">Manuals</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../docs/terms-of-use.html" rel="" target="">
 <span class="menu-text">Terms of use</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../docs/contact.html" rel="" target="">
 <span class="menu-text">Contact</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#research-cloud-portal" id="toc-research-cloud-portal" class="nav-link active" data-scroll-target="#research-cloud-portal">Research Cloud portal</a></li>
  <li><a href="#create-storage-volume" id="toc-create-storage-volume" class="nav-link" data-scroll-target="#create-storage-volume">Create storage volume</a>
  <ul class="collapse">
  <li><a href="#why-a-storage-volume" id="toc-why-a-storage-volume" class="nav-link" data-scroll-target="#why-a-storage-volume">Why a storage volume?</a></li>
  <li><a href="#how-to-create-a-storage-volume" id="toc-how-to-create-a-storage-volume" class="nav-link" data-scroll-target="#how-to-create-a-storage-volume">How to create a storage volume?</a></li>
  <li><a href="#where-can-i-find-the-storage-volume" id="toc-where-can-i-find-the-storage-volume" class="nav-link" data-scroll-target="#where-can-i-find-the-storage-volume">Where can I find the storage volume?</a></li>
  </ul></li>
  <li><a href="#create-a-workspace" id="toc-create-a-workspace" class="nav-link" data-scroll-target="#create-a-workspace">Create a workspace</a>
  <ul class="collapse">
  <li><a href="#how-to-create-a-workspace" id="toc-how-to-create-a-workspace" class="nav-link" data-scroll-target="#how-to-create-a-workspace">How to create a workspace?</a></li>
  </ul></li>
  <li><a href="#pausing-resuming-deleting-a-workspace" id="toc-pausing-resuming-deleting-a-workspace" class="nav-link" data-scroll-target="#pausing-resuming-deleting-a-workspace">Pausing, Resuming, Deleting a workspace</a></li>
  <li><a href="#getting-access-to-your-workspace" id="toc-getting-access-to-your-workspace" class="nav-link" data-scroll-target="#getting-access-to-your-workspace">Getting access to your workspace</a>
  <ul class="collapse">
  <li><a href="#browser-access" id="toc-browser-access" class="nav-link" data-scroll-target="#browser-access">Browser access</a></li>
  <li><a href="#rdp-remote-desktop-protocol" id="toc-rdp-remote-desktop-protocol" class="nav-link" data-scroll-target="#rdp-remote-desktop-protocol">RDP (Remote Desktop Protocol)</a></li>
  <li><a href="#ssh-secure-shell-protocol." id="toc-ssh-secure-shell-protocol." class="nav-link" data-scroll-target="#ssh-secure-shell-protocol.">SSH (secure shell protocol).</a></li>
  </ul></li>
  <li><a href="#getting-data-inside-your-workspace" id="toc-getting-data-inside-your-workspace" class="nav-link" data-scroll-target="#getting-data-inside-your-workspace">Getting data inside your workspace</a>
  <ul class="collapse">
  <li><a href="#mounting-online-storage" id="toc-mounting-online-storage" class="nav-link" data-scroll-target="#mounting-online-storage">Mounting online storage</a></li>
  <li><a href="#transferring-data" id="toc-transferring-data" class="nav-link" data-scroll-target="#transferring-data">Transferring data</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/UtrechtUniversity/vre-docs/edit/main/docs/getting-started.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Getting Started</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>[UNDER DEVELOPMENT] This page describes all general steps that a user needs to perform to be able to start working with SURF Research cloud:</p>
<p>Contents:</p>
<ol type="1">
<li><a href="#create-storage">Creating storage</a></li>
<li><a href="#create-a-workspace">Creating a workspace</a></li>
<li><a href="#pausing-resuming-deleting-a-workspace">Pausing, Resuming, Deleting a workspace</a></li>
<li><a href="#getting-access-to-your-workspace">Logging in to your workspace</a></li>
<li><a href="#getting-data-inside-your-workspace">Getting data inside your workspace</a></li>
</ol>
<section id="research-cloud-portal" class="level2">
<h2 class="anchored" data-anchor-id="research-cloud-portal">Research Cloud portal</h2>
<p>When you have completed an <a href="https://utrechtuniversity.github.io/vre-docs/docs/accounts.html">onboarding procedure</a>, you can login using the following link:</p>
<p><a href="https://portal.live.surfresearchcloud.nl/"><strong>Research Cloud portal</strong></a></p>
</section>
<section id="create-storage-volume" class="level2">
<h2 class="anchored" data-anchor-id="create-storage-volume">Create storage volume</h2>
<section id="why-a-storage-volume" class="level3">
<h3 class="anchored" data-anchor-id="why-a-storage-volume">Why a storage volume?</h3>
<p>In most cases you need to create a storage volume before you create a workspace. A workspace has limited storage and is temporary; all data stored on the workspace itself are deleted when a workspace is deleted. You can see a storage volume as a USB stick that you can attach to a workspace. A storage volume is persistent, so when you remove a workspace, all data on the storage volume will remain there. Storage volumes have good performance and are suitable for I/O-intensive computing tasks.</p>
</section>
<section id="how-to-create-a-storage-volume" class="level3">
<h3 class="anchored" data-anchor-id="how-to-create-a-storage-volume">How to create a storage volume?</h3>
<p>In the Research Cloud portal:</p>
<ul>
<li>Click ‘Create new storage’</li>
<li>The Wizard will guide you through the steps, some tips:</li>
<li>Choose Storage HPC</li>
<li>Choose the <a href="https://servicedesk.surf.nl/wiki/pages/viewpage.action?pageId=17825822">Collaborative Organization</a> of the project for which you want to create the storage volume</li>
<li>Choose the wallet with which you ‘pay’ for the Storage Unit</li>
<li>Choose the size. It is not possible to resize it later on, so don’t choose too small, but also don’t choose too large because it will cost more credits.</li>
<li>Give your storage volume a descriptive name so you can recognize it later on (e.g.&nbsp;use the name of the project or experiment)</li>
</ul>
</section>
<section id="where-can-i-find-the-storage-volume" class="level3">
<h3 class="anchored" data-anchor-id="where-can-i-find-the-storage-volume">Where can I find the storage volume?</h3>
<p>When you created a workspace and chose to attach a storage volume, the storage volume can be found via the following directory path: <code>/data/volume_2</code> Typically you want to create a project folder in <code>volume_2</code> (e.g.&nbsp;<code>/data/volume_2/my_project</code>).</p>
</section>
</section>
<section id="create-a-workspace" class="level2">
<h2 class="anchored" data-anchor-id="create-a-workspace">Create a workspace</h2>
<p>A workspace can also be called a ‘Virtual Machine’ or a ‘Server’. It is a temporary ‘remote’ machine that you can login to and that has you can use to perform analyses or model runs. You ‘pay’ for the machine with the credits from your wallet. The more compute power you select the more credits it costs and the sooner your wallet will be empty.</p>
<section id="how-to-create-a-workspace" class="level3">
<h3 class="anchored" data-anchor-id="how-to-create-a-workspace">How to create a workspace?</h3>
<p>In the Research Cloud portal:</p>
<ul>
<li>Click ‘Create new workspace’</li>
<li>Select application (Ubuntu, R-studio etc.)</li>
<li>Choose the <a href="https://servicedesk.surf.nl/wiki/pages/viewpage.action?pageId=17825822">Collaborative Organization</a> of the project for which you want to create the workspace</li>
<li>Skip step 3 ‘Datasets’</li>
<li>Choose the wallet with which you ‘pay’ for the Storage Unit</li>
<li>Select Cloud provider (Surf HPC Cloud)</li>
<li>Select the size of your workspace (# of Cores and RAM, or when relevant GPU)</li>
<li>Select persistent storage volume (see above how to create one)</li>
<li>Set expiration date (default setting is 1 week). Important: on this date the machine and all data on it will be deleted without warning. Only data on the Storage volume will remain. The expiration date can be changed later on.</li>
<li>Give the workspace a descriptive title that you can recognize later on.</li>
<li>Click Submit</li>
</ul>
</section>
</section>
<section id="pausing-resuming-deleting-a-workspace" class="level2">
<h2 class="anchored" data-anchor-id="pausing-resuming-deleting-a-workspace">Pausing, Resuming, Deleting a workspace</h2>
<p>You always need a wallet to create a workspace, by default a workspace can only be paused, resumed and deleted by the one that has created it. You can use SRAM to give persons permission to PAUSE, RESUME and DELETE a workspace that is created by someone else. It is also possible to share a wallet with a member of your CO in SRAM. See <a href="../docs/accounts.html#add-collaborators-to-existing-project">Add collaborators to existing project</a>.</p>
</section>
<section id="getting-access-to-your-workspace" class="level2">
<h2 class="anchored" data-anchor-id="getting-access-to-your-workspace">Getting access to your workspace</h2>
<p>There are several ways to login to your workspace.</p>
<section id="browser-access" class="level3">
<h3 class="anchored" data-anchor-id="browser-access">Browser access</h3>
<section id="when" class="level4">
<h4 class="anchored" data-anchor-id="when">When?</h4>
<p>This is the easiest method and it can be used for most workspaces that have a Graphical user interface (Rstudio, Jupyter Notebook, Ubuntu Desktop, Matlab). It can not be used for Windows server. You can check if this method works for your workspace: look up your created workspace under workspaces in the dashboard of the research cloud portal. Click on the workspace (anywhere but don’t click the access button) and check the URL in the overview that opens. If the URL has an <code>https://</code> address it can be accessed via the browser.</p>
</section>
<section id="how" class="level4">
<h4 class="anchored" data-anchor-id="how">How?</h4>
<p>To be able to login via the Browser you need to <a href="https://servicedesk.surf.nl/wiki/display/WIKI/Log+in+to+your+workspace#Logintoyourworkspace-WorkspaceAccesswithTOTP">setup a Time Based Password for your Research Cloud account</a>.</p>
<p>The workspaces can be accessed via your web browser by clicking the yellow access button. The username that you need to type when you want to access the workspace can be found under the ‘Profile’ tab in the Research Cloud portal. The password to fill in is the Time based password (aka TOTP password) from the authenticator app on your mobile phone.</p>
</section>
</section>
<section id="rdp-remote-desktop-protocol" class="level3">
<h3 class="anchored" data-anchor-id="rdp-remote-desktop-protocol">RDP (Remote Desktop Protocol)</h3>
<section id="when-1" class="level4">
<h4 class="anchored" data-anchor-id="when-1">When?</h4>
<p>This method can be used for most Windows Server workspaces, and any other workspaces that have an URL starting with <code>RDP://</code> when you click on the workspace in the research cloud portal.</p>
</section>
<section id="how-1" class="level4">
<h4 class="anchored" data-anchor-id="how-1">How?</h4>
<p>To be able to login via RDP you need to <a href="https://servicedesk.surf.nl/wiki/display/WIKI/Log+in+to+your+workspace#Logintoyourworkspace-WorkspaceAccesswithTOTP">setup a Time Based Password for your Research Cloud account</a>.</p>
<p>You need an Remote Desktop client to be able to connect via RDP. On a Windows and MacOS PC you can use an application called ‘Remote Desktop’, on Linux we recommend ‘Remmina’.</p>
<p>The username that you need to type when you want to access the workspace can be found under the ‘Profile’ tab in the Research Cloud portal. The password to fill in is the Time based password (aka TOTP password) from the authenticator app on your mobile phone.</p>
</section>
</section>
<section id="ssh-secure-shell-protocol." class="level3">
<h3 class="anchored" data-anchor-id="ssh-secure-shell-protocol.">SSH (secure shell protocol).</h3>
<section id="when-2" class="level4">
<h4 class="anchored" data-anchor-id="when-2">When?</h4>
<p>For some workspaces this is the only option to login to your workspace. These are typically command line only workspaces (e.g.&nbsp;Ubuntu 20.04 command line).</p>
<p>Since connection via SSH also works for most other workspace types, it could also be a useful option in some other scenarios, e.g.&nbsp;when you want to <a href="../docs/manuals/ssh-data-transfer-methods.html">copy a file from your laptop to the workspace</a>.</p>
</section>
<section id="how-2" class="level4">
<h4 class="anchored" data-anchor-id="how-2">How?</h4>
<p>The research cloud documentation provides instructions on <a href="https://servicedesk.surf.nl/wiki/display/WIKI/Log+in+to+your+workspace#Logintoyourworkspace-AccessaworkspacewithSSH">how to set up SSH for research cloud</a>.</p>
<p>To connect to the workspace from a Windows computer you need specific software to use a ‘shell’ (also known as ‘terminal’), examples include Git Bash, PuTTY and MobaXterm. If you need to install something new, we would recommend <a href="https://mobaxterm.mobatek.net/">MobaXterm</a>.</p>
<p>On MacOS and Linux machines you can use the standard ‘Terminal’.</p>
</section>
</section>
</section>
<section id="getting-data-inside-your-workspace" class="level2">
<h2 class="anchored" data-anchor-id="getting-data-inside-your-workspace">Getting data inside your workspace</h2>
<section id="mounting-online-storage" class="level3">
<h3 class="anchored" data-anchor-id="mounting-online-storage">Mounting online storage</h3>
<p>If you have a Research Drive account, you can mount it in your workspace. This method is most easy, and works good for working with small datasets (e.g.&nbsp;&lt;1 GB).</p>
</section>
<section id="transferring-data" class="level3">
<h3 class="anchored" data-anchor-id="transferring-data">Transferring data</h3>
<p>In many cases it is more reliable to get a copy of your data on the Storage unit that is attached to your workspace.<br>
Depending on where your data is stored and the workspace that you are using, the following options are available:</p>
<ul>
<li>Upload from your laptop (Jupyter Notebook and Rstudio Workspaces)</li>
<li><a href="../manuals/ssh-data-transfer-methods.qmd">scp/ssh</a> (most workspaces)</li>
<li>Download using the internet browser (on Ubuntu Desktop and Windows workspaces, for data stored on e.g.&nbsp;surfdrive, onedrive, etc.)</li>
<li><a href="../manuals/icommands.qmd">irods icommands</a> (for data stored on Yoda, works on Ubuntu based workspaces (including Jupyter and Rstudio)</li>
<li><a href="../manuals/rclone-researchcloud.qmd">rclone</a> (for data stored on a cloud storage platform (e.g.&nbsp;surfdrive, onedrive, dropbox)</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>